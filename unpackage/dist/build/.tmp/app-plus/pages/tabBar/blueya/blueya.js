(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/blueya/blueya"],{3946:function(t,e,a){"use strict";a.r(e);var o=a("d334"),n=a("482f");for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);a("d872");var s=a("2877"),r=Object(s["a"])(n["default"],o["a"],o["b"],!1,null,null,null);e["default"]=r.exports},"482f":function(t,e,a){"use strict";a.r(e);var o=a("fcde"),n=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);e["default"]=n.a},d334:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},n=[];a.d(e,"a",function(){return o}),a.d(e,"b",function(){return n})},d872:function(t,e,a){"use strict";var o=a("e368"),n=a.n(o);n.a},e368:function(t,e,a){},fcde:function(t,e,a){"use strict";(function(t){var a,o,n,i,s,r,l,u;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var d={data:function(){return{bArray:[],no_match_list:[],match_list:[],send_data_onoff:!1,send_data_list:"测试打印数据"}},onShow:function(){a=plus.android.runtimeMainActivity(),o=plus.android.importClass("android.content.Context"),a.getSystemService(o.BLUETOOTH_SERVICE),n=plus.android.importClass("android.bluetooth.BluetoothAdapter"),i=n.getDefaultAdapter(),s=plus.android.importClass("android.bluetooth.BluetoothDevice"),r=plus.android.importClass("android.content.IntentFilter")},methods:{print:function(e){console.log(e," at pages/tabBar/blueya/blueya.vue:87");var a=this;t.showLoading({title:"蓝牙连接中..."}),a.print_bluetooth(e)},print_bluetooth:function(e){var a=this;t.hideLoading();var o=plus.android.importClass("java.util.UUID"),n=o.fromString("00001101-0000-1000-8000-00805F9B34FB");u=i.getRemoteDevice(e),plus.android.importClass(u),l=u.createInsecureRfcommSocketToServiceRecord(n),plus.android.importClass(l);var s=l.isConnected();if(console.log("islink:"," at pages/tabBar/blueya/blueya.vue:121"),console.log(s," at pages/tabBar/blueya/blueya.vue:122"),t.showToast({title:"准备连接",duration:2e3}),!l.isConnected()){t.showToast({title:"检测到设备未连接，尝试连接....",duration:2e3}),console.log("检测到设备未连接，尝试连接...."," at pages/tabBar/blueya/blueya.vue:132");try{l.connect()}catch(r){return t.showToast({title:"准备出错",duration:2e3}),void console.log("连接出错"," at pages/tabBar/blueya/blueya.vue:140")}}t.showToast({title:"连接成功",duration:2e3}),console.log("设备已连接"," at pages/tabBar/blueya/blueya.vue:148"),a.send_data_onoff=!0},send_data:function(){var e=this;if(console.log(" at pages/tabBar/blueya/blueya.vue:156"),l.isConnected()){t.showToast({title:"已连接，打印",duration:2e3}),console.log("已连接，打印"," at pages/tabBar/blueya/blueya.vue:162");var a=l.getOutputStream();plus.android.importClass(a);var o=e.send_data_list,n=plus.android.invoke(o,"getBytes","gbk");a.write(n),a.flush(),u=null,l.close()}else t.showToast({title:"未连接，不打印",duration:2e3}),console.log("未连接"," at pages/tabBar/blueya/blueya.vue:176")},open_bluetooth:function(){i.isEnabled()||(i.enable(),t.showToast({title:"蓝牙已启动",duration:2e3}))},close_bluetooth:function(){var e=this;e.no_match_list=[],e.match_list=[],i.isEnabled()&&(i.disable(),t.showToast({title:"蓝牙已关闭",duration:2e3}))},bluetooth_list:function(){var e=this;e.match_list=[];var a=i.getBondedDevices();plus.android.importClass(a);var o=a.iterator();plus.android.importClass(o);while(o.hasNext()){var n=o.next();plus.android.importClass(n);var s={name:n.getName(),SN:n.getAddress()};e.match_list.push(s),t.hideLoading()}},search_bluetooth:function(e){var a=this;i.isEnabled()?void 0!=e.length?t.showModal({title:"提示",content:"是否配对此蓝牙？",success:function(o){o.confirm&&(console.log("用户点击确定"," at pages/tabBar/blueya/blueya.vue:240"),t.showLoading({title:"蓝牙匹配中..."}),a.search_pipei(e))}}):(t.showLoading({title:"蓝牙搜索中..."}),a.search_pipei()):t.showToast({title:"请先打开蓝牙",duration:3e3})},search_pipei:function(e){var o=this;o.bluetooth_list(),o.bArray=[],o.no_match_list=[];var n=new r,l=new s;i.startDiscovery();var u=plus.android.implements("io.dcloud.android.content.BroadcastReceiver",{onReceive:function(n,i){try{if(plus.android.importClass(i),"android.bluetooth.adapter.action.DISCOVERY_FINISHED"==i.getAction())t.hideLoading(),a.unregisterReceiver(u);else{if(l=i.getParcelableExtra(s.EXTRA_DEVICE),e==l.getAddress()&&l.createBond()&&(console.log("配对成功"," at pages/tabBar/blueya/blueya.vue:281"),t.showToast({title:"配对成功",duration:2e3}),t.hideLoading()),null==l)return a.unregisterReceiver(u),t.hideLoading(),void o.bluetooth_list();var r=l.getAddress()+l.getName();if(-1==o.bArray.indexOf(r)){o.bArray.push(r);var d={name:l.getName(),SN:l.getAddress()};o.no_match_list.push(d),console.log(JSON.stringify(o.no_match_list)," at pages/tabBar/blueya/blueya.vue:304")}}}catch(c){console.error(c," at pages/tabBar/blueya/blueya.vue:309")}}});n.addAction(l.ACTION_FOUND),n.addAction(i.ACTION_DISCOVERY_STARTED),n.addAction(i.ACTION_DISCOVERY_FINISHED),n.addAction(i.ACTION_STATE_CHANGED),a.registerReceiver(u,n)}}};e.default=d}).call(this,a("6e42")["default"])}},[["5a81","common/runtime","common/vendor"]]]);